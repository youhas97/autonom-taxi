\documentclass[projektplan/plan.tex]{subfiles}

% tabell för aktivitet
\newcounter{activitycatno} % nummer för kategori
\newcounter{activityno}[activitycatno] % nummer för varje aktivitet
\renewcommand\theactivityno{\theactivitycatno.\arabic{activityno}}

\newenvironment{activitylist}
{
    \setlength{\tabcolsep}{12pt}
    \renewcommand{\arraystretch}{1.6}
    \begin{longtable}{p{18mm}p{25mm}p{65mm}p{6mm}p{7mm}}
        \bfseries Nr &
        \bfseries Aktivitet &
        \bfseries Beskrivning &
        \bfseries Tid &
        \bfseries Ber.
	\\\hline\endhead
}{
    \end{longtable}
}

\newcommand{\activity}[5]{
    \refstepcounter{activityno}\label{act:#1}
    %nr            % akt    % beskr % tid   % beroenden
    \theactivityno & #2     & #5    & #3    & #4 \\
}
\newcommand{\actcat}[1]{
    \hline\multicolumn{5}{c}{#1}\refstepcounter{activitycatno}\\\hline}

\newcommand{\arefproc}[1]{\ref{act:#1} }
\NewDocumentCommand\aref{>{\SplitList{,}}m}{\ProcessList{#1}{\arefproc}}

\begin{document}

\section{Aktiviteter}
Nedan följer en lista av alla de aktiviter som hela projektet har delats upp i.
Aktiviteter är uppdelade i olika kategorier och är numrerade efter kategori.
Tidskolumnen visar en uppskattning av antalet timmar som aktiviteten förväntas
att ta. Kolumnen för beroenden visar vilka andra aktiviteter som måste vara
avklarade innan en aktivitet kan bli avklarad.

\begin{activitylist}
    \actcat{Kommunikationsmodul}
    \activity{comm:design}{Design}{20}{}{Designa konstruktionsmodulen.}
    \activity{comm:constr}{Konstruktion}{20}{\aref{comm:design}}{Konstruera
    hårdvaran av kommunikationsmodulen.}
    \activity{comm:sw}{Mjukvara}{40}{\aref{comm:design}}{Designa och
    implementera ett basprogram som körs på Raspberry Pi-processorn.}
    \activity{comm:cam}{Kamera}{8}{\aref{comm:sw}}{Installera kamera och gör
    dess bilder bearbetningsbara.}
    \activity{comm:remote}{Fjärrstyrning}{5}{\aref{comm:sw}}{Skicka och ta emot
    fjärrstyrningskommandon.}

    \actcat{Bildbearbetning}
    \activity{ip:edge}{Upptäck kanter.}{10}{\aref{comm:cam}}{Upptäck
    kanter i bilder.}
    \activity{ip:line}{Upptäck linjer.}{10}{\aref{ip:edge}}{Upptäck
    linjemarkeringar på vägen.}
    \activity{ip:2d}{Transformera linjer till
    karta.}{10}{\ref{act:ip:line}}{Transformera perspektivbild av linjer till
    en ortografisk projektion sedd uppifrån.}
    \activity{ip:err}{Avgör felvärde.}{10}{\aref{ip:2d}}{Beräkna felvärde från
    linjekarta.}

    \actcat{Styrmodul}
    \activity{ctrl:design}{Design}{10}{}{Designa styrmodulen.}
    \activity{ctrl:constr}{Konstruktion}{10}{\aref{ctrl:design}}{Konstruera
    hårdvaran av styrmodulen.}
    \activity{ctrl:sw}{Mjukvara}{30}{\aref{ctrl:design}}{Designa och
    implementera ett basprogram som körs på styrmodulens mikrokontroller.}
    \activity{ctrl:drive}{Drivmotor}{2}{\aref{ctrl:constr,ctrl:sw}}{Reglera
    taxins fart genom att kontrollera drivmotorn utifrån kommunikationsmodulens
    kommandon.}
    \activity{ctrl:steer}{Svängmotor}{2}{\aref{ctrl:constr,ctrl:sw}}{Reglera
    svängradien genom att kontrollera svängmotorn utifrån kommandon.}
    \activity{ctrl:break}{Broms}{2}{\aref{ctrl:drive}}{Se till att bilen kan
    bromsa.}

    \actcat{Sensormodul}
    \activity{sens:design}{Design}{10}{}{Designa sensormodulen.}
    \activity{sens:design}{3D-skrivare}{5}{}{Rita i CAD lämpliga fotfästen för
sensorer}
    \activity{sens:constr}{Konstruktion}{10}{\aref{sens:design}}{Konstruera
    hårdvaran av sensormodulen.}
    \activity{sens:sw}{Mjukvara}{30}{\aref{sens:design}}{Designa och
    implementera ett basprogram som körs på sensormodulens mikrokontroller.}
    \activity{sens:sens}{Installera
    sensorer.}{10}{\aref{sens:constr,sens:constr}}{Koppla sensorer och gör dess
    värden tillgängliga.}
    \activity{sens:filter}{Filtrera brus}{4}{\aref{sens:sens}}{Filtrera brus
    från analoga sensorer.}
    \activity{sens:conv}{Konvertera värden}{3}{\aref{sens:sens}}{Konvertera
    sensorvärden till SI-enheter.}
    \activity{sens:send}{Skicka värden}{5}{\aref{sens:conv}}{Skicka värden till
    kommunikationsmodulen.}
    \activity{sens:lcd}{LCD-display}{4}{\aref{sens:sens}}{Visa utvalda värden
    på LCD-display.}

    \actcat{Användargränssnitt}
    \activity{ui:rc}{Styra taxi}{10}{}{Gränssnitt för att styra taxi.}
    \activity{ui:param}{Mata in parametrar}{2}{}{Mata in konstantparametrer
    under körning.}
    \activity{ui:data}{Visa mätdata}{2}{}{Visa upp mätdata från taxin.}
    \activity{ui:map-in}{Mata in karta}{10}{}{Mata in en karta av banan.}
    \activity{ui:map}{Rita karta}{10}{}{Rita en karta på gränssnittet med
    taxins nuvarande position markerad.}

    \actcat{Anslutningar}
    \activity{io:voltage}{Konvertera spänning}{5}{}{Se till att Raspberry Pi:n
    kan kommunicera via 5V-buss.}
    \activity{io:wireless}{Trådlös länk}{8}{}{Implementera en trådlös länk
    mellan kommunikationsmodulen och fjärrklienten.}
    \activity{io:comm-sens}{Komm-sensor}{15}{}{Implementera seriellt protokoll
    för att kommunicera mellan kommunikations- och sensormodul.}
    \activity{io:comm-styr}{Komm-styr}{15}{}{Implementera seriellt protokoll
    för att kommunicera mellan kommunikations- och styrmodul.}

    \actcat{Autonom körning}
    \activity{sdc:map}{Tolka karta}{10}{\aref{ui:map-in}}{Tolka inmatad karta,
    skapa en lämplig representation.}
    \activity{sdc:tsp}{Hitta närmaste väg}{10}{\aref{sdc:map}}{Hitta närmaste
    vägen mellan två stopplinjer i karta.}
    \activity{sdc:roundabout}{Kör igenom rondell}{10}{}{Kör autonomnt genom
    rondeller med godtycklig utfart.}
    \activity{sdc:map}{Avgör position.}{8}{\aref{sdc:map}}{Bestäm taxins
    position i karta.}
    \activity{sdc:reg}{Följ vägfil}{10}{\aref{ip:err,ctrl:drive,ctrl:steer}}
    {Reglera styrning utefter felvärde och följ höger vägfil.}
    \activity{sdc:stop-line}{Upptäck stopplinjer}{5}{}{Upptäck stopplinjer i
    vägen.}
    \activity{sdc:nav}{Navigera}{20}{\aref{sdc:map,sdc:reg,sdc:stop-line}}{Navigera
    till godtycklig stopplinje.}
    \activity{sdc:pocket}{Parkera}{10}{\aref{sdc:stop-line}}{Parkera i
    stoppficka vid stopplinje.}
    \activity{ui:obstacle}{Hantera hinder}{8}{}{Upptäck och stanna för hinder.}

    \actcat{Testning}
    \activity{test:unit}{Unit-tester}{40}{}{Designa och implementera unit tester
    för alla moduler.}
    \activity{test:int}{Integrations\-testning}{30}{}{Utför integrationstest
    mellan de olika modulerna.}
    \activity{test:system}{Systemtestning}{30}{}{Utför systemtest av hela
    systemet.}

    \actcat{Utbildning}
    \activity{edu:instr}{Mätinstrument}{5}{}{Lära sig använda mätinstrument.}
    \activity{edu:opencv}{OpenCV}{10}{}{Förstå hur OpenCV fungerar.}
    \activity{edu:avr}{AVR}{3}{}{Förstå arkitektur och I/O för
    AVR-processorer.}
    \activity{edu:proto}{Överförings\-protokoll}{3}{}{Undersök protokoll som
    I$^2$C, SPI, UART m.m.}
    \activity{edu:kicad}{KiCad}{3}{}{Lära sig använda KiCad.}

    \actcat{Dokument}
    \activity{doc:designspec}{Designspe\-cifikation}{50}{}{Skapa detaljerad
    design demonstrerad i en specifikation.}
    \activity{doc:circuit}{Designa kretsscheman}{20}{}{Designa och rita
    kretsscheman för elektronik.}
    \activity{doc:diagram}{Rita diagram}{20}{}{Rita dokuementerande diagram
    över kompontenter.}
    \activity{doc:tecdoc}{Teknisk
    dokumentation}{50}{\aref{doc:diagram}}{Dokumentera implementationen.}
    \activity{doc:study}{Efterstudie}{30}{}{Utför en efterstudie.}
    \activity{doc:manual}{Användar\-manual}{20}{}{Skriv en användarmanual.}

    \actcat{Administrativt}
    \activity{adm:meet}{Möten}{40}{}{Genomföra regelbundna möten.}
    \activity{adm:time}{Tidsrapporter}{10}{}{Rapportera tid varje vecka.}
    \activity{adm:status}{Statusrapporter}{5}{}{Rapportera status vid begäran.}
\end{activitylist}

\newpage

\end{document}
