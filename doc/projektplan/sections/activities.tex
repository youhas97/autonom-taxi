\documentclass[projektplan/plan.tex]{subfiles}

% tabell för aktivitet
\newcounter{activitycatno} % nummer för kategori
\newcounter{activityno}[activitycatno] % nummer för varje aktivitet
\renewcommand\theactivityno{\theactivitycatno.\arabic{activityno}}

\newenvironment{activitylist}
{
    \setlength{\tabcolsep}{12pt}
    \renewcommand{\arraystretch}{1.6}
    \begin{longtable}{p{18mm}p{25mm}p{65mm}p{6mm}p{7mm}}
        \bfseries Nr &
        \bfseries Aktivitet &
        \bfseries Beskrivning &
        \bfseries Tid &
        \bfseries Ber.
	\\\hline\endhead
}{
    \end{longtable}
}

\newcommand{\activity}[5]{
    \refstepcounter{activityno}\label{act:#1}
    %nr            % akt    % beskr % tid   % beroenden
    \theactivityno & #2     & #5    & #3    & #4 \\
}
\newcommand{\actcat}[1]{
    \hline\multicolumn{5}{c}{#1}\refstepcounter{activitycatno}\\\hline}

\newcommand{\arefproc}[1]{\ref{act:#1} }
\NewDocumentCommand\aref{>{\SplitList{,}}m}{\ProcessList{#1}{\arefproc}}

\begin{document}

\section{Aktiviteter}
Nedan följer listor av alla de aktiviter som projektet har delats upp i.
Aktiviteter är uppdelade i olika kategorier och är numrerade efter kategori.
Tidskolumnen visar en uppskattning av antalet timmar som aktiviteten förväntas
att ta. Kolumnen för beroenden visar vilka andra aktiviteter som måste vara
avklarade innan en aktivitet kan bli avklarad.

\subsection{Allmänna aktiviteter}
Här visas aktiviteter som är utspridda över både designfasen och
utförandefasen.
\begin{activitylist}
    \actcat{Utbildning}
    \activity{edu:instr}{Mätinstrument}{6}{}{Lära sig använda mätinstrument.}
    \activity{edu:opencv}{OpenCV}{6}{}{Förstå hur OpenCV fungerar.}
    \activity{edu:avr}{AVR}{6}{}{Förstå arkitektur och I/O för
    AVR-processorer.}
    \activity{edu:proto}{Överförings\-protokoll}{6}{}{Undersök protokoll som
    I$^2$C, SPI, UART m.m.}
    \activity{edu:kicad}{KiCad}{6}{}{Lära sig använda KiCad.}

    \actcat{Administrativt}
    \activity{adm:meet}{Möte}{40}{}{Genomföra möten.}
    \activity{adm:time}{Tidsrapporter}{20}{}{Rapportera tid varje vecka.}
    \activity{adm:status}{Statusrapporter}{5}{}{Rapportera status vid begäran.}
\end{activitylist}

\newpage
\subsection{Designfas}
Nedan följer de aktiviteter som är del av designfasen. Dessa aktiviteter och
delar av allmänna aktiviter samt en buffer summerar till 420 inplanerade timmar
under designfasen.

\begin{activitylist}
    \actcat{Design}
    \activity{des:hwsys}{Systemhårdvara}{45}{}{Designa sammankopplingen mellan
    alla moduler.}
    \activity{des:hwmod}{Modulshårdvara}{75}{}{Designa hårdvaran av
    kommunikationsmodulen, styrmodulen och sensormodulen.}
    \activity{des:sw}{Mjukvara}{65}{}{Designa strukturerna för fjärrklientens,
    kommunikationsmodulens, styrmodulens och sensormodulens program.}

    \actcat{Dokument}
    \activity{doc:spec}{Skriva}{75}{}{Skriva, formatera och sammanställa
    designspecifikation.}
    \activity{doc:bdiag}{Rita blockdiagram}{45}{}{Rita blockdiagram över hela systemet,
    kommunikationsmodulen, styrmodulen och sensormodulen.}
    \activity{doc:cdiag}{Rita kretsscheman}{45}{}{Rita kretsschema över hela
    systemet, kommunikationsmodulen, styrmodulen och sensormodulen.}
\end{activitylist}

\newpage
\subsection{Utförandefas}
Utförandefasen består av nedan aktiviteter och delar av allmänna aktiviteter.
Dessa aktiviteter samt en buffer summerar till 700 inplanerade timmar.
\begin{activitylist}
    \actcat{Allmänt}
    \activity{all:install}{Koppla och installera}{50}{}{Konstruera hårdvaran av
    hela systemet, kommunikationsmodulen, styrmodulen och sensormodulen.}
    \activity{all:sw}{Implementera mjukvarubaser}{60}{}{Implementera
    mjukvarubaser som körs på fjärrklienten, kommunikationsmodulen, styrmodulen
    och sensormodulen.}

    \actcat{Kommunikationsmodul}
    \activity{comm:cam}{Kamera}{8}{\aref{all:sw}}{Gör kamerans bilder
    bearbetningsbara.}
    \activity{comm:remote}{Fjärrstyrning}{5}{\aref{all:sw}}{Skicka och ta emot
    fjärrstyrningskommandon.}

    \actcat{Bildbearbetning}
    \activity{ip:edge}{Upptäck kanter.}{15}{\aref{comm:cam}}{Upptäck kanter i
    bilder.}
    \activity{ip:line}{Upptäck linjer.}{15}{\aref{ip:edge}}{Upptäck
    linjemarkeringar på vägen.}
    \activity{ip:2d}{Transformera linjer.}{15}{\ref{act:ip:line}}{Transformera
    perspektivbild av linjer till en ortografisk projektion sedd uppifrån.}
    \activity{ip:err}{Avgör felvärde.}{15}{\aref{ip:2d}}{Beräkna felvärde från
    linjekarta.}

    \actcat{Autonom körning}
    \activity{sdc:map}{Tolka karta}{10}{\aref{ui:map-in}}{Tolka inmatad karta,
    skapa en lämplig representation.}
    \activity{sdc:tsp}{Hitta närmaste väg}{10}{\aref{sdc:map}}{Hitta närmaste
    vägen mellan två stopplinjer i karta.}
    \activity{sdc:roundabout}{Kör igenom rondell}{10}{\aref{all:sw}}{Kör
    autonomt genom rondeller via godtycklig in- och utfart.}
    \activity{sdc:gps}{Avgör position.}{8}{\aref{all:sw,sdc:map}}{Bestäm taxins
    position i karta.}
    \activity{sdc:reg}{Följ vägfil}{10}{\aref{all:sw,ip:err,ctrl:drive,
    ctrl:steer}} {Reglera styrning utefter felvärde och följ höger vägfil.}
    \activity{sdc:stop-line}{Upptäck stopplinjer}{5}{\aref{all:sw}}{Upptäck
    stopplinjer i vägen.}
    \activity{sdc:nav}{Navigera}{20}{\aref{sdc:gps,sdc:reg,sdc:stop-line}}{Navigera
    till godtycklig stopplinje.}
    \activity{sdc:pocket}{Parkera}{10}{\aref{sdc:stop-line}}{Parkera i
    stoppficka vid stopplinje.}
    \activity{ui:obstacle}{Hantera hinder}{8}{\aref{all:sw}}{Upptäck och stanna
    för hinder.}

    \actcat{Styrmodul}
    \activity{ctrl:drive}{Drivmotor}{5}{\aref{all:install,all:sw}}{Reglera
    taxins fart genom att kontrollera drivmotorn utifrån kommunikationsmodulens
    kommandon.}
    \activity{ctrl:steer}{Svängmotor}{5}{\aref{all:install,all:sw}}{Reglera
    svängradien genom att kontrollera svängmotorn utifrån kommandon.}
    \activity{ctrl:break}{Broms}{5}{\aref{ctrl:drive}}{Se till att bilen kan
    bromsa.}

    \actcat{Sensormodul}
    \activity{sens:design}{3D-utskrifter}{5}{}{Rita och skriv ut lämpliga
    fotfästen för sensorer}
    \activity{sens:filter}{Filtrera brus}{10}{\aref{all:install}}{Filtrera brus
    från analoga sensorer.}
    \activity{sens:conv}{Konvertera värden}{5}{\aref{all:install}}{Konvertera
    sensorvärden till SI-enheter.}
    \activity{sens:send}{Skicka värden}{10}{\aref{sens:conv}}{Skicka värden
    till kommunikationsmodulen.}
    \activity{sens:lcd}{LCD-display}{8}{\aref{all:install}}{Visa utvalda värden
    på LCD-display.}

    \actcat{Användargränssnitt}
    \activity{ui:rc}{Styra taxi}{10}{\aref{all:sw}}{Gränssnitt för att styra
    taxi.}
    \activity{ui:param}{Mata in parametrar}{5}{\aref{all:sw}}{Mata in
    konstantparametrer under körning.}
    \activity{ui:data}{Visa mätdata}{5}{\aref{all:sw}}{Visa upp mätdata från
    taxin.}
    \activity{ui:map-in}{Mata in karta}{10}{\aref{all:sw}}{Mata in en karta av
    banan.}
    \activity{ui:map}{Rita karta}{10}{\aref{all:sw}}{Rita en karta på
    gränssnittet med taxins nuvarande position markerad.}

    \actcat{Anslutningar}
    \activity{io:voltage}{Konvertera spänning}{8}{}{Se till att Raspberry Pi:n
    kan kommunicera via 5V-buss.}
    \activity{io:wireless}{Trådlös
    länk}{10}{\aref{all:sw,all:install}}{Implementera en trådlös länk mellan
    kommunikationsmodulen och fjärrklienten.}
    \activity{io:comm-sens}{Komm-sensor}{15}{\aref{all:sw,all:install}}{Implementera
    seriellt protokoll för att kommunicera mellan kommunikations- och
    sensormodul.}
    \activity{io:comm-styr}{Komm-styr}{15}{\aref{all:install,all:sw}}{Implementera
    seriellt protokoll för att kommunicera mellan kommunikations- och
    styrmodul.}

    \actcat{Testning}
    \activity{test:unit}{Unit-tester}{40}{}{Designa och implementera unit tester
    för alla moduler.}
    \activity{test:int}{Integrations\-testning}{30}{}{Utför integrationstest
    mellan de olika modulerna.}
    \activity{test:system}{Systemtestning}{30}{}{Utför systemtest av hela
    systemet.}

    \actcat{Dokument}
    \activity{doc:tecdoc}{Teknisk dokumentation}{50}{}{Dokumentera
    implementationen.}
    \activity{doc:study}{Efterstudie}{20}{}{Utför en efterstudie.}
    \activity{doc:manual}{Användar\-manual}{20}{}{Skriv en användarmanual.}
\end{activitylist}

\newpage

\end{document}
